{"ast":null,"code":"import { createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, createElementVNode as _createElementVNode, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\n\nconst _hoisted_1 = /*#__PURE__*/_createTextVNode(\"用户更新\");\n\nconst _hoisted_2 = /*#__PURE__*/_createTextVNode(\" 在此可以增加用户信息\");\n\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"br\", null, null, -1);\n\nconst _hoisted_4 = /*#__PURE__*/_createTextVNode(\" 注意：想要增加用户图片，在增加商品后在编辑介面进行 \");\n\nconst _hoisted_5 = /*#__PURE__*/_createTextVNode(\"mdi-account-plus\");\n\nconst _hoisted_6 = /*#__PURE__*/_createTextVNode(\" 更新用户 \");\n\nconst _hoisted_7 = /*#__PURE__*/_createTextVNode(\"更新成功\");\n\nconst _hoisted_8 = /*#__PURE__*/_createTextVNode(\"更新失败\");\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_v_card_title = _resolveComponent(\"v-card-title\");\n\n  const _component_v_card_subtitle = _resolveComponent(\"v-card-subtitle\");\n\n  const _component_v_icon = _resolveComponent(\"v-icon\");\n\n  const _component_v_btn = _resolveComponent(\"v-btn\");\n\n  const _component_v_card_text = _resolveComponent(\"v-card-text\");\n\n  const _component_v_card = _resolveComponent(\"v-card\");\n\n  const _component_v_text_field = _resolveComponent(\"v-text-field\");\n\n  const _component_v_file_input = _resolveComponent(\"v-file-input\");\n\n  const _component_v_img = _resolveComponent(\"v-img\");\n\n  const _component_v_avatar = _resolveComponent(\"v-avatar\");\n\n  const _component_v_snackbar = _resolveComponent(\"v-snackbar\");\n\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createVNode(_component_v_card, {\n    style: {\n      \"height\": \"200px\"\n    },\n    color: \"#4480A6\"\n  }, {\n    default: _withCtx(() => [_createVNode(_component_v_card_title, {\n      class: \"text-h4 font-weight-black text-white mt-6 ml-4\"\n    }, {\n      default: _withCtx(() => [_hoisted_1]),\n      _: 1\n    }), _createVNode(_component_v_card_subtitle, {\n      class: \"text-h6 font-weight-black text-white mt-4 ml-4\"\n    }, {\n      default: _withCtx(() => [_hoisted_2, _hoisted_3, _hoisted_4]),\n      _: 1\n    }), _createVNode(_component_v_card_text, null, {\n      default: _withCtx(() => [_createVNode(_component_v_btn, {\n        color: \"#263F73\",\n        class: \"font-weight-black text-white mt-2 ml-4\",\n        plain: \"\",\n        onClick: $setup.validate\n      }, {\n        default: _withCtx(() => [_createVNode(_component_v_icon, null, {\n          default: _withCtx(() => [_hoisted_5]),\n          _: 1\n        }), _hoisted_6]),\n        _: 1\n      }, 8, [\"onClick\"])]),\n      _: 1\n    })]),\n    _: 1\n  }), _createVNode(_component_v_card, {\n    class: \"mt-6\"\n  }, {\n    default: _withCtx(() => [_createVNode(_component_v_text_field, {\n      modelValue: _ctx.name,\n      \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => _ctx.name = $event),\n      counter: 10,\n      rules: $setup.nameRules,\n      label: \"Name\",\n      required: \"\"\n    }, null, 8, [\"modelValue\", \"rules\"]), _createVNode(_component_v_text_field, {\n      modelValue: _ctx.email,\n      \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => _ctx.email = $event),\n      rules: $setup.emailRules,\n      label: \"E-mail\",\n      required: \"\"\n    }, null, 8, [\"modelValue\", \"rules\"]), _createVNode(_component_v_text_field, {\n      modelValue: _ctx.password,\n      \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => _ctx.password = $event),\n      rules: $setup.passwordRules,\n      label: \"Password\",\n      required: \"\"\n    }, null, 8, [\"modelValue\", \"rules\"]), _createVNode(_component_v_text_field, {\n      modelValue: _ctx.phone,\n      \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => _ctx.phone = $event),\n      rules: $setup.phoneRules,\n      label: \"Phone\",\n      required: \"\"\n    }, null, 8, [\"modelValue\", \"rules\"]), _createVNode(_component_v_text_field, {\n      modelValue: _ctx.area,\n      \"onUpdate:modelValue\": _cache[4] || (_cache[4] = $event => _ctx.area = $event),\n      label: \"Area\",\n      required: \"\"\n    }, null, 8, [\"modelValue\"]), _createVNode(_component_v_text_field, {\n      modelValue: _ctx.age,\n      \"onUpdate:modelValue\": _cache[5] || (_cache[5] = $event => _ctx.age = $event),\n      label: \"Age\",\n      required: \"\"\n    }, null, 8, [\"modelValue\"]), _createVNode(_component_v_file_input, {\n      label: \"File input\",\n      filled: \"\",\n      \"prepend-icon\": \"mdi-camera\",\n      \"show-size\": \"\",\n      chips: \"\",\n      id: \"input\"\n    }), _createVNode(_component_v_avatar, {\n      size: \"50px\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_v_img, {\n        alt: \"Avatar\",\n        src: 'http://1.12.253.71:8081/queryUserImg/' + _ctx.id,\n        id: \"avatar\"\n      }, null, 8, [\"src\"])]),\n      _: 1\n    })]),\n    _: 1\n  }), _createVNode(_component_v_snackbar, {\n    modelValue: $setup.updateSuccess,\n    \"onUpdate:modelValue\": _cache[6] || (_cache[6] = $event => $setup.updateSuccess = $event)\n  }, {\n    default: _withCtx(() => [_hoisted_7]),\n    _: 1\n  }, 8, [\"modelValue\"]), _createVNode(_component_v_snackbar, {\n    modelValue: $setup.updateFailed,\n    \"onUpdate:modelValue\": _cache[7] || (_cache[7] = $event => $setup.updateFailed = $event)\n  }, {\n    default: _withCtx(() => [_hoisted_8]),\n    _: 1\n  }, 8, [\"modelValue\"])], 64);\n}","map":{"version":3,"mappings":"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","names":["_createElementVNode","_createVNode","_component_v_card","style","color","_component_v_card_title","class","_component_v_card_subtitle","_component_v_card_text","_component_v_btn","plain","onClick","$setup","_component_v_icon","_component_v_text_field","_ctx","$event","counter","rules","label","required","_component_v_file_input","filled","chips","id","_component_v_avatar","size","_component_v_img","alt","src","_component_v_snackbar"],"sourceRoot":"","sources":["C:\\Users\\tpmp1\\Desktop\\vue-project\\minishop\\src\\views\\back\\saler\\salerEditUser.vue"],"sourcesContent":["<template>\r\n  <v-card style=\"height: 200px;\" color=\"#4480A6\">\r\n    <v-card-title class=\"text-h4 font-weight-black text-white mt-6 ml-4\">用户更新</v-card-title>\r\n    <v-card-subtitle class=\"text-h6 font-weight-black text-white mt-4 ml-4\">\r\n      在此可以增加用户信息<br>\r\n      注意：想要增加用户图片，在增加商品后在编辑介面进行\r\n    </v-card-subtitle>\r\n    <v-card-text>\r\n      <v-btn\r\n          color=\"#263F73\"\r\n          class=\"font-weight-black text-white mt-2 ml-4\"\r\n          plain\r\n          @click=\"validate\"\r\n      >\r\n        <v-icon>mdi-account-plus</v-icon>\r\n        更新用户\r\n      </v-btn>\r\n      <!--      <v-btn-->\r\n      <!--          color=\"#263F73\"-->\r\n      <!--          class=\"font-weight-black text-white mt-2 ml-4\"-->\r\n      <!--          plain-->\r\n      <!--          @click=\"submitFiles\"-->\r\n      <!--      >-->\r\n      <!--        <v-icon>mdi-account-plus</v-icon>-->\r\n      <!--        上传图片-->\r\n      <!--      </v-btn>-->\r\n    </v-card-text>\r\n  </v-card>\r\n  <v-card class=\"mt-6\">\r\n    <v-text-field\r\n        v-model=\"name\"\r\n        :counter=\"10\"\r\n        :rules=\"nameRules\"\r\n        label=\"Name\"\r\n        required\r\n    ></v-text-field>\r\n    <v-text-field\r\n        v-model=\"email\"\r\n        :rules=\"emailRules\"\r\n        label=\"E-mail\"\r\n        required\r\n    ></v-text-field>\r\n    <v-text-field\r\n        v-model=\"password\"\r\n        :rules=\"passwordRules\"\r\n        label=\"Password\"\r\n        required\r\n    ></v-text-field>\r\n    <v-text-field\r\n        v-model=\"phone\"\r\n        :rules=\"phoneRules\"\r\n        label=\"Phone\"\r\n        required\r\n    ></v-text-field>\r\n    <v-text-field\r\n        v-model=\"area\"\r\n        label=\"Area\"\r\n        required\r\n    ></v-text-field>\r\n    <v-text-field\r\n        v-model=\"age\"\r\n        label=\"Age\"\r\n        required\r\n    ></v-text-field>\r\n    <v-file-input\r\n        label=\"File input\"\r\n        filled\r\n        prepend-icon=\"mdi-camera\"\r\n        show-size\r\n        chips\r\n        id=\"input\"\r\n    ></v-file-input>\r\n    <v-avatar\r\n        size=\"50px\"\r\n    >\r\n      <v-img\r\n          alt=\"Avatar\"\r\n          :src=\"'http://1.12.253.71:8081/queryUserImg/'+ id\"\r\n          id=\"avatar\"\r\n      ></v-img>\r\n    </v-avatar>\r\n\r\n\r\n  </v-card>\r\n  <v-snackbar v-model=\"updateSuccess\">更新成功</v-snackbar>\r\n  <v-snackbar v-model=\"updateFailed\">更新失败</v-snackbar>\r\n</template>\r\n\r\n<script>\r\nimport {onMounted, ref, watch, toRefs, reactive} from \"vue\";\r\nimport {useRoute} from \"vue-router\";\r\nimport {getSalerById} from \"../../../../network/saler\";\r\nimport {getUserById, updateUser, uploadUserImg} from \"../../../../network/user\";\r\n\r\nexport default {\r\n  name: \"salerEditUser\",\r\n  setup() {\r\n    let route = useRoute();\r\n    let updateSuccess = ref(false);\r\n    let updateFailed = ref(false);\r\n\r\n    let form = reactive({\r\n      id: \"\",\r\n      name: \"\",\r\n      email: \"\",\r\n      password: \"\",\r\n      phone: \"\",\r\n      area: \"\",\r\n      age: \"\",\r\n    })\r\n\r\n    form.id = route.query.id;\r\n\r\n    let valid = true\r\n    let nameRules = [\r\n      v => !!v || 'Name is required',\r\n      v => (v && v.length <= 10) || 'Name must be less than 10 characters',\r\n    ]\r\n    let emailRules = [\r\n      v => !!v || 'E-mail is required',\r\n      v => /.+@.+\\..+/.test(v) || 'E-mail must be valid',\r\n    ]\r\n    let passwordRules = [\r\n      v => !!v || 'E-mail is required',\r\n    ]\r\n    let phoneRules = [\r\n      v => !!v || 'Name is required',\r\n      v => (v && v.length !== 11) || 'Name must be less than 10 characters',\r\n    ]\r\n\r\n    const validate = () => {\r\n\r\n      updateUser(form).then(res=>{\r\n        let status = res.data.status\r\n        if (status >= 1) {\r\n          if (document.getElementById(\"input\").files[0] == null) {\r\n            updateSuccess.value = true\r\n            setTimeout(()=>{\r\n              updateSuccess.value = false\r\n            },1000)\r\n            return\r\n          }\r\n          let formData = new window.FormData();\r\n          formData.append(\"fileid\", form.id)\r\n          formData.append(\"file\", document.getElementById(\"input\").files[0])\r\n          uploadUserImg(formData).then(res=>{\r\n            let imgStatus = res.data.status;\r\n            if (imgStatus === 1) {\r\n              updateSuccess.value = true\r\n              setTimeout(()=>{\r\n                updateSuccess.value = false\r\n              },1000)\r\n            } else {\r\n              updateFailed.value = true\r\n              setTimeout(()=>{\r\n                updateFailed.value = false\r\n              },1000)\r\n            }\r\n          })\r\n        } else {\r\n          updateFailed.value = true\r\n          setTimeout(()=>{\r\n            updateFailed.value = false\r\n          },1000)\r\n        }\r\n      })\r\n\r\n    }\r\n\r\n    const init = () => {\r\n      getUserById(form.id).then(res=>{\r\n        form.name = res.data.name\r\n        form.email = res.data.email\r\n        form.password = res.data.password\r\n        form.phone = res.data.phone\r\n        form.area = res.data.area\r\n        form.age = res.data.age\r\n      })\r\n\r\n    }\r\n\r\n    onMounted(()=>{\r\n      init()\r\n    })\r\n\r\n    return {\r\n      valid,\r\n      nameRules,\r\n      emailRules,\r\n      passwordRules,\r\n      phoneRules,\r\n      ...toRefs(form),\r\n      validate,\r\n      updateSuccess,\r\n      updateFailed,\r\n      //submitFiles,\r\n    }\r\n\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>"]},"metadata":{},"sourceType":"module"}