{"ast":null,"code":"import { useRouter } from \"vue-router\";\nimport { useStore } from \"vuex\";\nimport { ref } from \"vue\";\nimport { reactive, toRefs } from \"vue\";\nimport { userLogin } from \"../../../network/userLogin\";\nexport default {\n  name: \"UserLogin\",\n\n  setup() {\n    const router = useRouter();\n    const store = useStore();\n    let loginFailed = ref(false);\n    const userinfo = reactive({\n      name: '',\n      password: ''\n    });\n\n    const validate = () => {\n      userLogin(userinfo).then(res => {\n        if (res.data.token != null) {\n          window.localStorage.setItem('JWT_User_Token', res.data.token);\n          store.commit('setUserId', res.data.id);\n          store.commit('setUserIsLogin', true);\n          console.log(store.state.user.id);\n          console.log(store.state.user.isLogin);\n          router.push(\"/index\");\n        } else {\n          loginFailed.value = true;\n          setTimeout(() => {\n            loginFailed.value = false;\n          }, 1000);\n        }\n      });\n    };\n\n    return { ...toRefs(userinfo),\n      validate,\n      loginFailed\n    };\n  }\n\n};","map":{"version":3,"mappings":"AAqEA,SAAQA,SAAR,QAAwB,YAAxB;AACA,SAAQC,QAAR,QAAuB,MAAvB;AACA,SAAQC,GAAR,QAAkB,KAAlB;AACA,SAAQC,QAAR,EAAkBC,MAAlB,QAA+B,KAA/B;AACA,SAAQC,SAAR,QAAwB,4BAAxB;AAEA,eAAe;AACbC,MAAI,EAAE,WADO;;AAEbC,OAAK,GAAG;AAEN,UAAMC,MAAK,GAAIR,SAAS,EAAxB;AACA,UAAMS,KAAI,GAAIR,QAAQ,EAAtB;AACA,QAAIS,WAAU,GAAIR,GAAG,CAAC,KAAD,CAArB;AAEA,UAAMS,QAAO,GAAIR,QAAQ,CAAC;AACxBG,UAAI,EAAE,EADkB;AAExBM,cAAQ,EAAE;AAFc,KAAD,CAAzB;;AAKA,UAAMC,QAAO,GAAI,MAAM;AACrBR,eAAS,CAACM,QAAD,CAAT,CAAoBG,IAApB,CAAyBC,GAAG,IAAE;AAC5B,YAAIA,GAAG,CAACC,IAAJ,CAASC,KAAT,IAAkB,IAAtB,EAA4B;AAC1BC,gBAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,gBAA5B,EAA8CL,GAAG,CAACC,IAAJ,CAASC,KAAvD;AACAR,eAAK,CAACY,MAAN,CAAa,WAAb,EAA0BN,GAAG,CAACC,IAAJ,CAASM,EAAnC;AACAb,eAAK,CAACY,MAAN,CAAa,gBAAb,EAA+B,IAA/B;AACAE,iBAAO,CAACC,GAAR,CAAYf,KAAK,CAACgB,KAAN,CAAYC,IAAZ,CAAiBJ,EAA7B;AACAC,iBAAO,CAACC,GAAR,CAAYf,KAAK,CAACgB,KAAN,CAAYC,IAAZ,CAAiBC,OAA7B;AACAnB,gBAAM,CAACoB,IAAP,CAAY,QAAZ;AACF,SAPA,MAOO;AACLlB,qBAAW,CAACmB,KAAZ,GAAoB,IAApB;AACAC,oBAAU,CAAC,MAAI;AACbpB,uBAAW,CAACmB,KAAZ,GAAoB,KAApB;AACD,WAFS,EAEP,IAFO,CAAV;AAGF;AACD,OAdD;AAeF,KAhBA;;AAkBA,WAAO,EACL,GAAGzB,MAAM,CAACO,QAAD,CADJ;AAELE,cAFK;AAGLH;AAHK,KAAP;AAKF;;AApCa,CAAf","names":["useRouter","useStore","ref","reactive","toRefs","userLogin","name","setup","router","store","loginFailed","userinfo","password","validate","then","res","data","token","window","localStorage","setItem","commit","id","console","log","state","user","isLogin","push","value","setTimeout"],"sourceRoot":"","sources":["C:\\Users\\tpmp1\\Desktop\\vue-project\\minishop\\src\\views\\front\\UserLogin.vue"],"sourcesContent":["<template>\r\n  <v-app>\r\n\r\n<!--    <v-app-bar app color=\"#6456BF\">-->\r\n<!--      <v-app-bar-title class=\"text-white font-weight-black\">销售人员后台登入</v-app-bar-title>-->\r\n<!--    </v-app-bar>-->\r\n\r\n\r\n\r\n    <v-main>\r\n      <v-container fluid>\r\n        <v-row class=\"justify-center align-center\" style=\"height: 95vh;\">\r\n          <v-card width=\"400\" class=\"\">\r\n            <!--            <v-img-->\r\n            <!--                height=\"200\"-->\r\n            <!--                src=\"https://cdn.pixabay.com/photo/2020/07/12/07/47/bee-5396362_1280.jpg\"-->\r\n            <!--                cover-->\r\n            <!--                class=\"text-white\"-->\r\n            <!--            >-->\r\n            <!--            </v-img>-->\r\n\r\n            <v-card-title class=\"font-weight-black mt-2\">用户登入</v-card-title>\r\n\r\n            <v-card-text>\r\n              <v-form\r\n                  ref=\"form\"\r\n                  v-model=\"valid\"\r\n                  lazy-validation\r\n              >\r\n                <v-text-field\r\n                    v-model=\"name\"\r\n                    label=\"用户名\"\r\n                    required\r\n                    class=\"font-weight-black\"\r\n                ></v-text-field>\r\n\r\n                <v-text-field\r\n                    v-model=\"password\"\r\n                    label=\"密码\"\r\n                    required\r\n                    type=\"password\"\r\n                    class=\"font-weight-black\"\r\n                ></v-text-field>\r\n\r\n                <v-btn\r\n                    color=\"#733410\"\r\n                    class=\"mr-4 font-weight-black text-white\"\r\n                    @click=\"validate\"\r\n                >\r\n                  登入\r\n                </v-btn>\r\n\r\n              </v-form>\r\n            </v-card-text>\r\n          </v-card>\r\n        </v-row>\r\n      </v-container>\r\n    </v-main>\r\n\r\n    <v-footer app>\r\n\r\n    </v-footer>\r\n\r\n    <v-snackbar v-model=\"loginFailed\">登录失败</v-snackbar>\r\n\r\n  </v-app>\r\n</template>\r\n\r\n<script>\r\nimport {useRouter} from \"vue-router\";\r\nimport {useStore} from \"vuex\";\r\nimport {ref} from \"vue\";\r\nimport {reactive, toRefs} from \"vue\";\r\nimport {userLogin} from \"../../../network/userLogin\";\r\n\r\nexport default {\r\n  name: \"UserLogin\",\r\n  setup() {\r\n\r\n    const router = useRouter();\r\n    const store = useStore();\r\n    let loginFailed = ref(false);\r\n\r\n    const userinfo = reactive({\r\n      name: '',\r\n      password: ''\r\n    })\r\n\r\n    const validate = () => {\r\n      userLogin(userinfo).then(res=>{\r\n        if (res.data.token != null) {\r\n          window.localStorage.setItem('JWT_User_Token', res.data.token);\r\n          store.commit('setUserId', res.data.id);\r\n          store.commit('setUserIsLogin', true);\r\n          console.log(store.state.user.id);\r\n          console.log(store.state.user.isLogin);\r\n          router.push(\"/index\");\r\n        } else {\r\n          loginFailed.value = true;\r\n          setTimeout(()=>{\r\n            loginFailed.value = false;\r\n          }, 1000)\r\n        }\r\n      })\r\n    }\r\n\r\n    return {\r\n      ...toRefs(userinfo),\r\n      validate,\r\n      loginFailed,\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>"]},"metadata":{},"sourceType":"module"}